<!doctype html>
<html>
    <head>
        <meta charset="utf-8"/>
        <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0" />
        <title>Weather Map Project</title>
        <link rel="icon" type="image/x-icon" href="./img/rainy-day.png" />

        <!-- Loading: Font Awesome 4.7.0 -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
        <!-- Loading: Bootstrap CSS Framework 5.0.2 -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous" />
        <!-- Loading: Mapbox GL API 2.6.1 -->
        <link href="https://api.mapbox.com/mapbox-gl-js/v2.6.1/mapbox-gl.css" rel="stylesheet" />
        <!-- Loading: Mapbox GL Geocoder 4.7.2 -->
        <link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.7.2/mapbox-gl-geocoder.css" type="text/css" />


        <style>

            @import url("https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap");

            /*-------------------------------------------*\
            Global Variables
            \*-------------------------------------------*/
            :root {
                --salmon: rgb(252, 154, 145);
                --teal: rgb(1, 148, 148);
                --body-background-color: white;
                --current-weather-font-color: black;
                --chart-tab-font-color: var(--teal);
                --muted: #6c757d;
            }

            * {
                padding: 0;
                margin: 0;
                box-sizing: border-box;
            }

            body {
                background: var(--body-background-color);
                font-family:'Roboto', sans-serif;
            }

            /*-------------------------------------------*\
                General Styling
            \*-------------------------------------------*/
            h1, h2, h3, h4, h5, h6 { margin: 0;}
            h2 {
                color: var(--current-weather-font-color);
                border-bottom: 1px solid teal;
                padding-bottom: 10px;
            }
            .section-spacing { margin: 0 0 50px 0; }

            /*-------------------------------------------*\
                Header
            \*-------------------------------------------*/
            #header {
                background-image: url("./img/sky-unsplash.png");
                background-size: cover;

                padding-right: 3rem;
                padding-left: 3rem;
            }

            #navbar {
                padding: 30px 0;
                display: flex;
                justify-content: space-between;
            }
            #navbar a { text-decoration: none; }
            #navbar .brand{
                display: flex;
                align-items: baseline;
            }
            #navbar .title {
                color: white;
                font-size: 3rem;
                font-weight: 300;
                line-height: 1.2;
                border-right: 3px solid var(--salmon);
                padding-right: 5px;
            }
            #navbar .subtitle {
                color: var(--teal);
                font-size: 0.85rem;
                padding-left: 6px;
            }
            #navbar .dark-background {
                color: white;
                background: #6c757d;
                padding: 6px 12px;
                margin-top: 8px;
                font-size: 17px;
                border: none;
            }
            #navbar .searchbar-label {
                float: left;
                border-radius: 5px 0 0 5px;
                cursor: default;
            }
            #navbar .searchbar {
                width: 30vw;
                padding: 6px;
                margin-top: 8px;
                font-size: 17px;
                border: none;
                outline: 0;
            }
            #navbar .searchbar-button {
                float: right;
                cursor: pointer;
            }
            #navbar .dark-mode-button { border-radius: 0 5px 5px 0; }
            #navbar .searchbar-button:hover {
                transition: 0.25s;
                background: #586169;
            }

            /*-------------------------------------------*\
                Main
            \*-------------------------------------------*/
            #main {
                max-width: 1140px;
                margin: 0 auto;
                display: grid;
                grid-template-columns: 1fr 1fr;
                grid-template-rows: repeat(4, 1fr);
            }
            #hourly-readings {
                grid-column: span 2;
            }
            #top-stories {
                grid-column: span 2;
            }

            /*-------------------------------------------*\
            Main - Current Weather
            \*-------------------------------------------*/

            #current-weather .date-time { color: var(--salmon); }
            #current-weather .city-country {
                border-bottom: 1px solid var(--teal);
                width: 300px;
                color: var(--current-weather-font-color);
            }
            #current-weather .container {
                position: relative;
            }
            #current-weather .weather-icon {
                top: 10px;
                position: absolute;
                width: 100px;
                height: 100px;
                object-fit: cover;
                display: grid;
                place-content: center;
            }
            #current-weather .current-temp {
                padding-left: 96px;
                font-size: 5rem;
                display: inline-block;
                color: var(--current-weather-font-color);
            }
            #current-weather .feels-like {
                color: var(--muted);
                font-size: 1.5rem;
                display: inline-block;
            }
            #current-weather .clouds-description {
                color: var(--current-weather-font-color);
                font-size: 24px;
            }
            #current-weather .details-section {
                border-left: 1px solid var(--teal);
                padding-left: 20px;
            }
            #current-weather ul {
                list-style: none;
                columns: 2;
                -webkit-columns: 2;
                -moz-columns: 2;
                padding: 0;
            }
            #current-weather .details-style {
                font-size: 12px;
                color: var(--current-weather-font-color);
            }

            /*-------------------------------------------*\
            Main - Map
            \*-------------------------------------------*/
            #map {
                box-shadow:
                        0 1px 1px hsl(0deg 0% 0% / 0.075),
                        0 2px 2px hsl(0deg 0% 0% / 0.075),
                        0 4px 4px hsl(0deg 0% 0% / 0.075),
                        0 8px 8px hsl(0deg 0% 0% / 0.075),
                        0 16px 16px hsl(0deg 0% 0% / 0.075);
                height: 400px;
            }
        </style>
    </head>
    <body>

        <!----------------------------------
         HEADER
        ------------------------------------>

        <header id="header" class="section-spacing">
            <nav id="navbar">
                <a class="brand" href="/" >
                    <span class="title">Weather</span>
                    <span class="subtitle">PRO</span>
                </a>
                <div>
                    <div                            class="searchbar-label dark-background">City</div>
                    <input  id="searchbar"          class="searchbar" type="text" placeholder="Name"><!-- #searchbar -->
                    <div    id="dark-mode-button"   class="searchbar-button dark-mode-button dark-background"><i class="fa fa-adjust"></i></div><!-- #dark-mode-button -->
                    <div    id="search-button"      class="searchbar-button dark-background">Search</div><!-- #searchbar-button -->
                </div>
            </nav>
        </header><!-- #header -->

        <!----------------------------------
         MAIN
        ------------------------------------>

        <main id="main">

            <div id="current-weather">
                <h6 class="date-time"></h6>
                <h1 class="city-country"></h1>
                <div class="container">
                    <div class="weather-icon"></div>
                    <div class="current-temp"></div>
                    <div class="feels-like"></div>
                </div>
                <div class="clouds-description"></div>
                <div class="details-section">
                    <ul>
                        <li class="details-style wind-speed">Wind: </li>
                        <li class="details-style humidity">Humidity: </li>
                        <li class="details-style visibility">Visibility: </li>
                        <li class="details-style pressure">Pressure: </li>
                        <li class="details-style sunrise">Sunrise: </li>
                        <li class="details-style sunset">Sunset: </li>
                    </ul>
                </div>
            </div>
            <div id="map"></div>
            <div id="seven-day-forecast"></div>
            <div id="hourly-readings"></div>
            <div id="top-stories"></div>
        </main>

        <!----------------------------------
         EXTERNAL DEPENDENCIES
        ------------------------------------>

        <!-- jQuery -->
        <script src="js/jquery-2.2.4.js"></script>
        <!-- MapBox API -->
        <script src="https://api.mapbox.com/mapbox-gl-js/v2.6.1/mapbox-gl.js"></script>
        <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.7.2/mapbox-gl-geocoder.min.js"></script>
        <!-- BootStrap 5.0.2 -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

        <!----------------------------------
         INTERNAL DEPENDENCIES
        ------------------------------------>

        <!-- "Hidden" Keys -->
        <script src="js/key.js"></script>
        <!-- Main JS -->
        <script>

            /*----------------------------------
            CONSTANTS VARIABLES
            ----------------------------------*/

            // const STARTING_MAPBOX_COORD = [-98.489597, 29.42681];

            const STARTING_MAPBOX_STYLE = 'mapbox://styles/mapbox/streets-v9'       // Starting mapbox map style - Street v9
            const STARTING_MAPBOX_COORD = [-98.489597, 29.42681];                   // Starting position: 600 Navarro St #600, San Antonio, TX 78205
            const STARTING_MAPBOX_ZOOM = 15;                                        // Starting zoom

            let map = new mapboxgl.Map({
                accessToken: MAPBOX_API_KEY,
                container: 'map',
                style:  STARTING_MAPBOX_STYLE,
                center: STARTING_MAPBOX_COORD,
                zoom:   STARTING_MAPBOX_ZOOM
            });
            let marker = new mapboxgl.Marker({ draggable: true }).setLngLat(STARTING_MAPBOX_COORD).addTo(map);


            /*----------------------------------
            OPEN WEATHER API LOGIC
            ----------------------------------*/
            //--| Purpose: Fills the current weather object, seven-day forecast, and hourly report. |--//
            let getOpenWeatherData = function(longitude, latitude) {
                const OPEN_WEATHER_MAP_ONECALL_URL = 'https://api.openweathermap.org/data/2.5/onecall';
                const svgList = {
                    "clear sky":        `<svg fill="rgb(252, 154, 145)" width="75" height="75" viewBox="0 0 25 25"><path d="M12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,2L14.39,5.42C13.65,5.15 12.84,5 12,5C11.16,5 10.35,5.15 9.61,5.42L12,2M3.34,7L7.5,6.65C6.9,7.16 6.36,7.78 5.94,8.5C5.5,9.24 5.25,10 5.11,10.79L3.34,7M3.36,17L5.12,13.23C5.26,14 5.53,14.78 5.95,15.5C6.37,16.24 6.91,16.86 7.5,17.37L3.36,17M20.65,7L18.88,10.79C18.74,10 18.47,9.23 18.05,8.5C17.63,7.78 17.1,7.15 16.5,6.64L20.65,7M20.64,17L16.5,17.36C17.09,16.85 17.62,16.22 18.04,15.5C18.46,14.77 18.73,14 18.87,13.21L20.64,17M12,22L9.59,18.56C10.33,18.83 11.14,19 12,19C12.82,19 13.63,18.83 14.37,18.56L12,22Z"/></svg>`,
                    "few clouds":       `<svg fill="rgb(252, 154, 145)" width="75" height="75" viewBox="0 0 25 25"><path d="M12.74,5.47C15.1,6.5 16.35,9.03 15.92,11.46C17.19,12.56 18,14.19 18,16V16.17C18.31,16.06 18.65,16 19,16A3,3 0 0,1 22,19A3,3 0 0,1 19,22H6A4,4 0 0,1 2,18A4,4 0 0,1 6,14H6.27C5,12.45 4.6,10.24 5.5,8.26C6.72,5.5 9.97,4.24 12.74,5.47M11.93,7.3C10.16,6.5 8.09,7.31 7.31,9.07C6.85,10.09 6.93,11.22 7.41,12.13C8.5,10.83 10.16,10 12,10C12.7,10 13.38,10.12 14,10.34C13.94,9.06 13.18,7.86 11.93,7.3M13.55,3.64C13,3.4 12.45,3.23 11.88,3.12L14.37,1.82L15.27,4.71C14.76,4.29 14.19,3.93 13.55,3.64M6.09,4.44C5.6,4.79 5.17,5.19 4.8,5.63L4.91,2.82L7.87,3.5C7.25,3.71 6.65,4.03 6.09,4.44M18,9.71C17.91,9.12 17.78,8.55 17.59,8L19.97,9.5L17.92,11.73C18.03,11.08 18.05,10.4 18,9.71M3.04,11.3C3.11,11.9 3.24,12.47 3.43,13L1.06,11.5L3.1,9.28C3,9.93 2.97,10.61 3.04,11.3M19,18H16V16A4,4 0 0,0 12,12A4,4 0 0,0 8,16H6A2,2 0 0,0 4,18A2,2 0 0,0 6,20H19A1,1 0 0,0 20,19A1,1 0 0,0 19,18Z"/></svg>`,
                    "scattered clouds": `<svg fill="rgb(252, 154, 145)" width="75" height="75" viewBox="0 0 25 25"><path d="M6,19A5,5 0 0,1 1,14A5,5 0 0,1 6,9C7,6.65 9.3,5 12,5C15.43,5 18.24,7.66 18.5,11.03L19,11A4,4 0 0,1 23,15A4,4 0 0,1 19,19H6M19,13H17V12A5,5 0 0,0 12,7C9.5,7 7.45,8.82 7.06,11.19C6.73,11.07 6.37,11 6,11A3,3 0 0,0 3,14A3,3 0 0,0 6,17H19A2,2 0 0,0 21,15A2,2 0 0,0 19,13Z"/></svg>`,
                    "broken clouds":    `<svg fill="rgb(252, 154, 145)" width="75" height="75" viewBox="0 0 25 25"><path d="M6,19A5,5 0 0,1 1,14A5,5 0 0,1 6,9C7,6.65 9.3,5 12,5C15.43,5 18.24,7.66 18.5,11.03L19,11A4,4 0 0,1 23,15A4,4 0 0,1 19,19H6M19,13H17V12A5,5 0 0,0 12,7C9.5,7 7.45,8.82 7.06,11.19C6.73,11.07 6.37,11 6,11A3,3 0 0,0 3,14A3,3 0 0,0 6,17H19A2,2 0 0,0 21,15A2,2 0 0,0 19,13Z"/></svg>`,
                    "overcast clouds":  `<svg fill="rgb(252, 154, 145)" width="75" height="75" viewBox="0 0 25 25"><path d="M6,19A5,5 0 0,1 1,14A5,5 0 0,1 6,9C7,6.65 9.3,5 12,5C15.43,5 18.24,7.66 18.5,11.03L19,11A4,4 0 0,1 23,15A4,4 0 0,1 19,19H6M19,13H17V12A5,5 0 0,0 12,7C9.5,7 7.45,8.82 7.06,11.19C6.73,11.07 6.37,11 6,11A3,3 0 0,0 3,14A3,3 0 0,0 6,17H19A2,2 0 0,0 21,15A2,2 0 0,0 19,13Z"/></svg>`,
                    "shower rain":      `<svg fill="rgb(252, 154, 145)" width="24" height="24" viewBox="0 0 24 24"><path d="M6,14.03A1,1 0 0,1 7,15.03C7,15.58 6.55,16.03 6,16.03C3.24,16.03 1,13.79 1,11.03C1,8.27 3.24,6.03 6,6.03C7,3.68 9.3,2.03 12,2.03C15.43,2.03 18.24,4.69 18.5,8.06L19,8.03A4,4 0 0,1 23,12.03C23,14.23 21.21,16.03 19,16.03H18C17.45,16.03 17,15.58 17,15.03C17,14.47 17.45,14.03 18,14.03H19A2,2 0 0,0 21,12.03A2,2 0 0,0 19,10.03H17V9.03C17,6.27 14.76,4.03 12,4.03C9.5,4.03 7.45,5.84 7.06,8.21C6.73,8.09 6.37,8.03 6,8.03A3,3 0 0,0 3,11.03A3,3 0 0,0 6,14.03M12,14.15C12.18,14.39 12.37,14.66 12.56,14.94C13,15.56 14,17.03 14,18C14,19.11 13.1,20 12,20A2,2 0 0,1 10,18C10,17.03 11,15.56 11.44,14.94C11.63,14.66 11.82,14.4 12,14.15M12,11.03L11.5,11.59C11.5,11.59 10.65,12.55 9.79,13.81C8.93,15.06 8,16.56 8,18A4,4 0 0,0 12,22A4,4 0 0,0 16,18C16,16.56 15.07,15.06 14.21,13.81C13.35,12.55 12.5,11.59 12.5,11.59"/></svg>`,
                    "rain":             `<svg fill="rgb(252, 154, 145)" width="24" height="24" viewBox="0 0 24 24"><path d="M12.75,4.47C15.1,5.5 16.35,8.03 15.92,10.46C17.19,11.56 18,13.19 18,15V15.17C18.31,15.06 18.65,15 19,15A3,3 0 0,1 22,18A3,3 0 0,1 19,21H17C17,21 16,21 16,20C16,19 17,19 17,19H19A1,1 0 0,0 20,18A1,1 0 0,0 19,17H16V15A4,4 0 0,0 12,11A4,4 0 0,0 8,15H6A2,2 0 0,0 4,17A2,2 0 0,0 6,19H7C7,19 8,19 8,20C8,21 7,21 7,21H6A4,4 0 0,1 2,17A4,4 0 0,1 6,13H6.27C5,11.45 4.6,9.24 5.5,7.25C6.72,4.5 9.97,3.24 12.75,4.47M11.93,6.3C10.16,5.5 8.09,6.31 7.31,8.07C6.85,9.09 6.93,10.22 7.41,11.13C8.5,9.83 10.16,9 12,9C12.7,9 13.38,9.12 14,9.34C13.94,8.06 13.18,6.86 11.93,6.3M13.55,2.63C13,2.4 12.45,2.23 11.88,2.12L14.37,0.82L15.27,3.71C14.76,3.29 14.19,2.93 13.55,2.63M6.09,3.44C5.6,3.79 5.17,4.19 4.8,4.63L4.91,1.82L7.87,2.5C7.25,2.71 6.65,3.03 6.09,3.44M18,8.71C17.91,8.12 17.78,7.55 17.59,7L19.97,8.5L17.92,10.73C18.03,10.08 18.05,9.4 18,8.71M3.04,10.3C3.11,10.9 3.25,11.47 3.43,12L1.06,10.5L3.1,8.28C3,8.93 2.97,9.61 3.04,10.3M12,18.91C12.59,19.82 13,20.63 13,21A1,1 0 0,1 12,22A1,1 0 0,1 11,21C11,20.63 11.41,19.82 12,18.91M12,15.62C12,15.62 9,19 9,21A3,3 0 0,0 12,24A3,3 0 0,0 15,21C15,19 12,15.62 12,15.62Z"/></svg>`,
                    "thunderstorm":     `<svg fill="rgb(252, 154, 145)" width="24" height="24" viewBox="0 0 24 24"><path d="M6,16A5,5 0 0,1 1,11A5,5 0 0,1 6,6C7,3.65 9.3,2 12,2C15.43,2 18.24,4.66 18.5,8.03L19,8A4,4 0 0,1 23,12A4,4 0 0,1 19,16H18A1,1 0 0,1 17,15A1,1 0 0,1 18,14H19A2,2 0 0,0 21,12A2,2 0 0,0 19,10H17V9A5,5 0 0,0 12,4C9.5,4 7.45,5.82 7.06,8.19C6.73,8.07 6.37,8 6,8A3,3 0 0,0 3,11A3,3 0 0,0 6,14H7A1,1 0 0,1 8,15A1,1 0 0,1 7,16H6M12,11H15L13,15H15L11.25,22L12,17H9.5L12,11Z"/></svg>`,
                    "snow":             `<svg fill="rgb(252, 154, 145)" width="24" height="24" viewBox="0 0 24 24"><path d="M6,14A1,1 0 0,1 7,15A1,1 0 0,1 6,16A5,5 0 0,1 1,11A5,5 0 0,1 6,6C7,3.65 9.3,2 12,2C15.43,2 18.24,4.66 18.5,8.03L19,8A4,4 0 0,1 23,12A4,4 0 0,1 19,16H18A1,1 0 0,1 17,15A1,1 0 0,1 18,14H19A2,2 0 0,0 21,12A2,2 0 0,0 19,10H17V9A5,5 0 0,0 12,4C9.5,4 7.45,5.82 7.06,8.19C6.73,8.07 6.37,8 6,8A3,3 0 0,0 3,11A3,3 0 0,0 6,14M7.88,18.07L10.07,17.5L8.46,15.88C8.07,15.5 8.07,14.86 8.46,14.46C8.85,14.07 9.5,14.07 9.88,14.46L11.5,16.07L12.07,13.88C12.21,13.34 12.76,13.03 13.29,13.17C13.83,13.31 14.14,13.86 14,14.4L13.41,16.59L15.6,16C16.14,15.86 16.69,16.17 16.83,16.71C16.97,17.24 16.66,17.79 16.12,17.93L13.93,18.5L15.54,20.12C15.93,20.5 15.93,21.15 15.54,21.54C15.15,21.93 14.5,21.93 14.12,21.54L12.5,19.93L11.93,22.12C11.79,22.66 11.24,22.97 10.71,22.83C10.17,22.69 9.86,22.14 10,21.6L10.59,19.41L8.4,20C7.86,20.14 7.31,19.83 7.17,19.29C7.03,18.76 7.34,18.21 7.88,18.07Z"/></svg>`,
                    "mist":             `<svg fill="rgb(252, 154, 145)" width="24" height="24" viewBox="0 0 24 24"><path d="M3,15H13A1,1 0 0,1 14,16A1,1 0 0,1 13,17H3A1,1 0 0,1 2,16A1,1 0 0,1 3,15M16,15H21A1,1 0 0,1 22,16A1,1 0 0,1 21,17H16A1,1 0 0,1 15,16A1,1 0 0,1 16,15M1,12A5,5 0 0,1 6,7C7,4.65 9.3,3 12,3C15.43,3 18.24,5.66 18.5,9.03L19,9C21.19,9 22.97,10.76 23,13H21A2,2 0 0,0 19,11H17V10A5,5 0 0,0 12,5C9.5,5 7.45,6.82 7.06,9.19C6.73,9.07 6.37,9 6,9A3,3 0 0,0 3,12C3,12.35 3.06,12.69 3.17,13H1.1L1,12M3,19H5A1,1 0 0,1 6,20A1,1 0 0,1 5,21H3A1,1 0 0,1 2,20A1,1 0 0,1 3,19M8,19H21A1,1 0 0,1 22,20A1,1 0 0,1 21,21H8A1,1 0 0,1 7,20A1,1 0 0,1 8,19Z"/></svg>`
                }

                $.ajax({
                    url: OPEN_WEATHER_MAP_ONECALL_URL,
                    type: 'GET',
                    data: {
                        lat:    latitude,
                        lon:    longitude,
                        appid:  OPEN_WEATHER_API_KEY,
                        units: 'imperial'
                    }
                }).done(data => {
                    const DEGREE = '\u00B0';
                    const capitalizeFirstLetter = string => string.replace(/^./, string[0].toUpperCase());
                    const getDateTime = (dt, timezone) => new Date(dt*1000+(timezone*1000));
                    const formatDate = date => date.toLocaleString('en-us', { month: 'short', day: 'numeric'});
                    const formatTime = time => time.toLocaleString('en-us', { timeStyle: 'short', timeZone: 'US/Central'});

                    let city = $('#current-weather');
                    let date = formatDate(getDateTime(data.current.dt, data.timezone_offset));
                    let time = formatTime(getDateTime(data.current.dt, data.timezone_offset));
                    let sunrise = formatTime(getDateTime(data.current.sunrise, data.timezone_offset));
                    let sunset = formatTime(getDateTime(data.current.sunset, data.timezone_offset));

                    city.find('.date-time').text(`${date}, ${time}`);
                    fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${STARTING_MAPBOX_COORD[0]},${STARTING_MAPBOX_COORD[1]}.json?access_token=${MAPBOX_API_KEY}`)
                        .then(res => res.json())
                        .then(data => {
                            let address = data.features[0].place_name.split(',');
                            city.find('.city-country').text(`${address[1]}, ${address[3]}`);
                        });
                    city.find('.weather-icon').html(svgList[`${data.current.weather[0].description}`]);
                    city.find('.current-temp').text(`${data.current.temp.toPrecision(2)}${DEGREE}F`);
                    city.find('.feels-like').text(`${data.current.feels_like.toPrecision(2)}${DEGREE}F`);
                    city.find('.clouds-description').text(`${capitalizeFirstLetter(data.current.weather[0].description)}`);
                    city.find('.wind-speed').text(`Wind: ${data.current.wind_speed} mph`);
                    city.find('.humidity').text(`Humidity: ${data.current.humidity} %`);
                    city.find('.visibility').text(`Visibility: ${(data.current.visibility/1000).toFixed(1)} km`);
                    city.find('.pressure').text(`Pressure: ${data.current.pressure} hPa`);
                    city.find('.sunrise').text(`Sunrise: ${sunrise}`);
                    city.find('.sunset').text(`Sunset: ${sunset}`);


                });
            }

            /*----------------------------------
            NEWS API LOGIC
            ----------------------------------*/
            //--| Purpose: Fills the 5 news cards with current weather related news stories. |--//
            function getNews() {
                let createUrl = (search, date, sortBy, key) => { return `https://newsapi.org/v2/everything?q=${search}&from=${date}&sortBy=${sortBy}&apiKey=${key}`; }
                let url = createUrl('Weather', '2022-02-02', 'relevancy', NEWS_API_KEY);
                fetch(new Request(url))
                    .then(res => res.json())
                    .then(data => {
                        let articles = data.articles;
                        $('.news-card').each(function(index){
                            $(this).find('img').attr('src', `${articles[index].urlToImage}`);
                            $(this).find('h5').html(`${articles[index].source.name}`);
                            $(this).find('p').html(`${articles[index].title}`);
                            $(this).find('small').html(`${formatDate(new Date(articles[index].publishedAt.slice(0, -1)))}`);
                            $(this).find('a').attr('href', `${articles[index].url}`);
                        });
                    });
            }

            /*----------------------------------
            GLOBAL FUNCTION CALLS
            ----------------------------------*/

            getOpenWeatherData(STARTING_MAPBOX_COORD[0], STARTING_MAPBOX_COORD[1]);
            getNews();

        </script>
    </body>
</html>