<!doctype html>
<html>
    <head>
        <meta charset="utf-8"/>
        <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0" />
        <title>Weather Map Project</title>
        <link rel="icon" type="image/x-icon" href="./img/rainy-day.png" />

        <!-- Loading: Font Awesome 4.7.0 -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
       <!-- Loading: Mapbox GL API 2.6.1 -->
        <link href="https://api.mapbox.com/mapbox-gl-js/v2.6.1/mapbox-gl.css" rel="stylesheet" />
        <!-- Loading: Mapbox GL Geocoder 4.7.2 -->
        <link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.7.2/mapbox-gl-geocoder.css" type="text/css" />


        <style>

            @import url("https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap");

            /*-------------------------------------------*\
            Global Variables
            \*-------------------------------------------*/
            :root {
                --salmon: rgb(252, 154, 145);
                --teal: rgb(1, 148, 148);
                --body-background-color: whitesmoke;

                --forecast-card-width: 175px;

                --current-weather-font-color: black;
                --chart-tab-font-color: var(--teal);
                --muted: #6c757d;
            }
            * {
                padding: 0;
                margin: 0;
                box-sizing: border-box;
            }
            body {
                background: var(--body-background-color);
                font-family:'Roboto', sans-serif;
                font-weight: 400;
            }

            /*-------------------------------------------*\
                General Styling
            \*-------------------------------------------*/
            h1, h2, h3, h4, h5, h6 { margin: 0;}
            h2 {
                color: var(--current-weather-font-color);
                border-bottom: 1px solid teal;
                padding-bottom: 10px;
            }
            .section-spacing { margin: 0 0 50px 0; }

            /*-------------------------------------------*\
                Header
            \*-------------------------------------------*/
            #header {
                background-image: url("./img/sky-unsplash.png");
                background-size: cover;

                padding-right: 3rem;
                padding-left: 3rem;
            }

            #navbar {
                padding: 30px 0;
                display: flex;
                justify-content: space-between;
            }
            #navbar a { text-decoration: none; }
            #navbar .brand{
                display: flex;
                align-items: baseline;
            }
            #navbar .title {
                color: white;
                font-size: 3rem;
                font-weight: 300;
                line-height: 1.2;
                border-right: 3px solid var(--salmon);
                padding-right: 5px;
            }
            #navbar .subtitle {
                color: var(--teal);
                font-size: 0.85rem;
                padding-left: 6px;
            }
            #navbar .dark-background {
                color: white;
                background: #6c757d;
                padding: 6px 12px;
                margin-top: 8px;
                font-size: 17px;
                border: none;
            }
            #navbar .searchbar-label {
                float: left;
                border-radius: 5px 0 0 5px;
                cursor: default;
            }
            #navbar .searchbar {
                width: 30vw;
                padding: 6px;
                margin-top: 8px;
                font-size: 17px;
                border: none;
                outline: 0;
            }
            #navbar .searchbar-button {
                float: right;
                cursor: pointer;
            }
            #navbar .dark-mode-button { border-radius: 0 5px 5px 0; }
            #navbar .searchbar-button:hover {
                transition: 0.25s;
                background: #586169;
            }

            /*-------------------------------------------*\
                Main
            \*-------------------------------------------*/
            #main {
                max-width: 1300px;
                margin: 0 auto;
                display: grid;
                grid-template-columns: 1fr 1fr;
                grid-template-rows: repeat(4, 450px);
            }
            #hourly-readings {
                grid-column: span 2;
            }
            #top-stories {
                grid-column: span 2;
            }

            /*-------------------------------------------*\
            Main - Current Weather
            \*-------------------------------------------*/

            #current-weather { height: 400px; }
            #current-weather .date-time {
                color: var(--salmon);
                font-size: 16px;
            }
            #current-weather .city-country {
                border-bottom: 1px solid var(--teal);
                width: 300px;
                color: var(--current-weather-font-color);
                font-size: 32px;
            }
            #current-weather .container {
                position: relative;
                margin: 10px 0;
                height: 100px;
            }
            #current-weather .weather-icon {
                position: absolute;
                width: 100px;
                height: 100px;
                object-fit: cover;
                display: grid;
                place-content: center;
            }
            #current-weather .current-temp {
                padding-left: 96px;
                font-size: 5rem;
                display: inline-block;
                color: var(--current-weather-font-color);
            }
            #current-weather .feels-like {
                color: var(--muted);
                font-size: 1.5rem;
                display: inline-block;
            }
            #current-weather .clouds-description {
                color: var(--current-weather-font-color);
                font-size: 24px;
                text-transform: capitalize;
            }
            #current-weather .details-section {
                border-left: 1px solid var(--teal);
                padding-left: 20px;
            }
            #current-weather ul {
                list-style: none;
                columns: 2;
                -webkit-columns: 2;
                -moz-columns: 2;
                padding: 0;
            }
            #current-weather li {
                margin: 5px 0;
            }
            #current-weather .details-style {
                font-size: 12px;
                color: var(--current-weather-font-color);
            }

            /*-------------------------------------------*\
            Main - Map
            \*-------------------------------------------*/
            #map {
                box-shadow: 0 1px 1px hsl(0deg 0% 0% / 0.075),
                0 2px 2px hsl(0deg 0% 0% / 0.075),
                0 4px 4px hsl(0deg 0% 0% / 0.075),
                0 8px 8px hsl(0deg 0% 0% / 0.075),
                0 16px 16px hsl(0deg 0% 0% / 0.075);
                height: 400px;
            }

            /*-------------------------------------------*\
                Main - 7 Day Forecast
            \*-------------------------------------------*/

            #weekly-forecast { grid-column: span 2; }
            #weekly-forecast .card-container {
                padding-top: 10px;

                display: grid;
                grid-template-columns: repeat(7, 1fr);
                grid-gap: 10px;
            }
            #weekly-forecast .card {
                width: var(--forecast-card-width);
                height: 400px;
                border: none;
                box-shadow: 0 1px 1px hsl(0deg 0% 0% / 0.075),
                0 2px 2px hsl(0deg 0% 0% / 0.075),
                0 4px 4px hsl(0deg 0% 0% / 0.075),
                0 8px 8px hsl(0deg 0% 0% / 0.075),
                0 16px 16px hsl(0deg 0% 0% / 0.075);
                background: linear-gradient(25deg, rgba(0,165,148,1) 0%, rgba(189,157,146,1) 100%, rgba(252,154,145,1) 100%);
            }
            #weekly-forecast .card-body {
                position: relative;
                background: transparent;
            }
            #weekly-forecast .day-time {
                position: absolute;
                top: 0;
                left: 0;

                width: 100px;
                height: 100px;

                overflow: hidden;
            }
            #weekly-forecast .day {
                position: absolute;
                top: 10px;
                left: 10px;

                font-size: 20px;
                width: 100%;

                padding-bottom: 5px;
                border-bottom: 1px solid var(--salmon);

                color: white;
            }
            #weekly-forecast .time {
                position: absolute;
                top: 45px;
                right: 0;

                font-size: 12px;

                color: white;
            }
            #weekly-forecast .weather-icon {
                position: relative;
                top: 40px;
                width: var(--forecast-card-width);
                height: 200px;
                overflow: hidden;
            }
            #weekly-forecast .weather-icon svg {
                position: absolute;
                right: -85px;
            }
            #weekly-forecast .high-low{
                text-align: center;
                color: white;

                width: 50%;
                margin: 50px auto 0 auto;
                padding-bottom: 3px;

                border-bottom: 1px solid var(--salmon);
            }
            #weekly-forecast .high {
                display: inline-block;
                font-size: 32px;
            }
            #weekly-forecast .low {
                color: #d2d2d2;
                display: inline-block;
                font-size: 16px;
            }
            #weekly-forecast .subscript {
                font-size: 75%;
            }
            #weekly-forecast .clouds-description {
                text-align: center;
                text-transform: capitalize;
                color: white;

                padding-top: 5px;
            }
            #weekly-forecast .readings {
                color: white;
                font-size: 12px;

                margin-top: 15px;

                display: grid;
                grid-template-columns: repeat(3, 1fr);
                grid-template-rows: 1fr 1fr;
                place-items: center;
            }
        </style>

    </head>
    <body>

        <!----------------------------------
         HEADER
        ------------------------------------>

        <header id="header" class="section-spacing">
            <nav id="navbar">
                <a class="brand" href="/" >
                    <span class="title">Weather</span>
                    <span class="subtitle">PRO</span>
                </a>
                <div>
                    <div                            class="searchbar-label dark-background">City</div>
                    <input  id="searchbar"          class="searchbar" type="text" placeholder="Name"><!-- #searchbar -->
                    <div    id="dark-mode-button"   class="searchbar-button dark-mode-button dark-background"><i class="fa fa-adjust"></i></div><!-- #dark-mode-button -->
                    <div    id="search-button"      class="searchbar-button dark-background">Search</div><!-- #searchbar-button -->
                </div>
            </nav>
        </header><!-- #header -->

        <!----------------------------------
         MAIN
        ------------------------------------>

        <main id="main">

            <div id="current-weather">
                <div class="date-time"></div>
                <div class="city-country"></div>
                <div class="container">
                    <div class="weather-icon"></div>
                    <div class="current-temp"></div>
                    <div class="feels-like"></div>
                </div>
                <div class="clouds-description"></div>
                <div class="details-section">
                    <ul>
                        <li class="details-style wind-speed">Wind: </li>
                        <li class="details-style humidity">Humidity: </li>
                        <li class="details-style visibility">Visibility: </li>
                        <li class="details-style pressure">Pressure: </li>
                        <li class="details-style sunrise">Sunrise: </li>
                        <li class="details-style sunset">Sunset: </li>
                    </ul>
                </div>
            </div>

            <div id="map"></div>

            <div id="weekly-forecast">
                <p><h2>Weekly Forecast</h2></p>
                <div class="card-container"></div>
            </div>

            <div id="hourly-readings"></div>

            <div id="top-stories"></div>
        </main>

        <!----------------------------------
         EXTERNAL DEPENDENCIES
        ------------------------------------>

        <!-- jQuery -->
        <script src="js/jquery-2.2.4.js"></script>
        <!-- MapBox API -->
        <script src="https://api.mapbox.com/mapbox-gl-js/v2.6.1/mapbox-gl.js"></script>
        <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.7.2/mapbox-gl-geocoder.min.js"></script>

        <!----------------------------------
         INTERNAL DEPENDENCIES
        ------------------------------------>

        <!-- "Hidden" Keys -->
        <script src="js/key.js"></script>
        <!-- Main JS -->
        <script>

            /*----------------------------------
            CONSTANTS VARIABLES
            ----------------------------------*/

            // const STARTING_MAPBOX_COORD = [-98.489597, 29.42681];

            const STARTING_MAPBOX_STYLE = 'mapbox://styles/mapbox/streets-v9'       // Starting mapbox map style - Street v9
            const STARTING_MAPBOX_COORD = [-98.489597, 29.42681];                   // Starting position: 600 Navarro St #600, San Antonio, TX 78205
            const STARTING_MAPBOX_ZOOM = 15;                                        // Starting zoom

            let map = new mapboxgl.Map({
                accessToken: MAPBOX_API_KEY,
                container: 'map',
                style:  STARTING_MAPBOX_STYLE,
                center: STARTING_MAPBOX_COORD,
                zoom:   STARTING_MAPBOX_ZOOM
            });
            let marker = new mapboxgl.Marker({ draggable: true }).setLngLat(STARTING_MAPBOX_COORD).addTo(map);


            /*----------------------------------
            OPEN WEATHER API LOGIC
            ----------------------------------*/
            //--| Purpose: Fills the current weather object, seven-day forecast, and hourly report. |--//
            let getOpenWeatherData = function(longitude, latitude) {
                const OPEN_WEATHER_MAP_ONECALL_URL = 'https://api.openweathermap.org/data/2.5/onecall';
                const svgList = {
                    "clear sky":        `<path d="M12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,2L14.39,5.42C13.65,5.15 12.84,5 12,5C11.16,5 10.35,5.15 9.61,5.42L12,2M3.34,7L7.5,6.65C6.9,7.16 6.36,7.78 5.94,8.5C5.5,9.24 5.25,10 5.11,10.79L3.34,7M3.36,17L5.12,13.23C5.26,14 5.53,14.78 5.95,15.5C6.37,16.24 6.91,16.86 7.5,17.37L3.36,17M20.65,7L18.88,10.79C18.74,10 18.47,9.23 18.05,8.5C17.63,7.78 17.1,7.15 16.5,6.64L20.65,7M20.64,17L16.5,17.36C17.09,16.85 17.62,16.22 18.04,15.5C18.46,14.77 18.73,14 18.87,13.21L20.64,17M12,22L9.59,18.56C10.33,18.83 11.14,19 12,19C12.82,19 13.63,18.83 14.37,18.56L12,22Z"/>`,

                    "few clouds":       `<path d="M12.74,5.47C15.1,6.5 16.35,9.03 15.92,11.46C17.19,12.56 18,14.19 18,16V16.17C18.31,16.06 18.65,16 19,16A3,3 0 0,1 22,19A3,3 0 0,1 19,22H6A4,4 0 0,1 2,18A4,4 0 0,1 6,14H6.27C5,12.45 4.6,10.24 5.5,8.26C6.72,5.5 9.97,4.24 12.74,5.47M11.93,7.3C10.16,6.5 8.09,7.31 7.31,9.07C6.85,10.09 6.93,11.22 7.41,12.13C8.5,10.83 10.16,10 12,10C12.7,10 13.38,10.12 14,10.34C13.94,9.06 13.18,7.86 11.93,7.3M13.55,3.64C13,3.4 12.45,3.23 11.88,3.12L14.37,1.82L15.27,4.71C14.76,4.29 14.19,3.93 13.55,3.64M6.09,4.44C5.6,4.79 5.17,5.19 4.8,5.63L4.91,2.82L7.87,3.5C7.25,3.71 6.65,4.03 6.09,4.44M18,9.71C17.91,9.12 17.78,8.55 17.59,8L19.97,9.5L17.92,11.73C18.03,11.08 18.05,10.4 18,9.71M3.04,11.3C3.11,11.9 3.24,12.47 3.43,13L1.06,11.5L3.1,9.28C3,9.93 2.97,10.61 3.04,11.3M19,18H16V16A4,4 0 0,0 12,12A4,4 0 0,0 8,16H6A2,2 0 0,0 4,18A2,2 0 0,0 6,20H19A1,1 0 0,0 20,19A1,1 0 0,0 19,18Z"/>`,
                    "scattered clouds": `<path d="M6,19A5,5 0 0,1 1,14A5,5 0 0,1 6,9C7,6.65 9.3,5 12,5C15.43,5 18.24,7.66 18.5,11.03L19,11A4,4 0 0,1 23,15A4,4 0 0,1 19,19H6M19,13H17V12A5,5 0 0,0 12,7C9.5,7 7.45,8.82 7.06,11.19C6.73,11.07 6.37,11 6,11A3,3 0 0,0 3,14A3,3 0 0,0 6,17H19A2,2 0 0,0 21,15A2,2 0 0,0 19,13Z"/>`,
                    "broken clouds":    `<path d="M23.5,11.65c0-1.77-1.43-3.2-3.2-3.2L19.9,8.47c-0.211-2.689-2.461-4.82-5.2-4.82c-1.36,0-2.59,0.52-3.51,1.37   C8.63,5.15,6.46,6.74,5.5,9c-2.76,0-5,2.24-5,5s2.24,5,5,5h13c2.21,0,4-1.79,4-4c0-0.32-0.05-0.63-0.12-0.939   C23.061,13.48,23.5,12.62,23.5,11.65z M18.5,17h-13c-1.66,0-3-1.34-3-3s1.34-3,3-3c0.14,0,0.28,0.02,0.42,0.04   c0.22,0.03,0.44,0.08,0.64,0.15c0.38-2.34,2.39-4.13,4.84-4.18L11.5,7c2.76,0,5,2.24,5,5v1h2c0.35,0,0.67,0.1,0.95,0.25   c0.569,0.311,0.97,0.9,1.03,1.58L20.5,15C20.5,16.1,19.6,17,18.5,17z"/>`,
                    "overcast clouds":  `<path d="M23.5,11.65c0-1.77-1.43-3.2-3.2-3.2L19.9,8.47c-0.211-2.689-2.461-4.82-5.2-4.82c-1.36,0-2.59,0.52-3.51,1.37   C8.63,5.15,6.46,6.74,5.5,9c-2.76,0-5,2.24-5,5s2.24,5,5,5h13c2.21,0,4-1.79,4-4c0-0.32-0.05-0.63-0.12-0.939   C23.061,13.48,23.5,12.62,23.5,11.65z M18.5,17h-13c-1.66,0-3-1.34-3-3s1.34-3,3-3c0.14,0,0.28,0.02,0.42,0.04   c0.22,0.03,0.44,0.08,0.64,0.15c0.38-2.34,2.39-4.13,4.84-4.18L11.5,7c2.76,0,5,2.24,5,5v1h2c0.35,0,0.67,0.1,0.95,0.25   c0.569,0.311,0.97,0.9,1.03,1.58L20.5,15C20.5,16.1,19.6,17,18.5,17z"/>`,

                    "light intensity shower rain":      `<path d="M6,14.03A1,1 0 0,1 7,15.03C7,15.58 6.55,16.03 6,16.03C3.24,16.03 1,13.79 1,11.03C1,8.27 3.24,6.03 6,6.03C7,3.68 9.3,2.03 12,2.03C15.43,2.03 18.24,4.69 18.5,8.06L19,8.03A4,4 0 0,1 23,12.03C23,14.23 21.21,16.03 19,16.03H18C17.45,16.03 17,15.58 17,15.03C17,14.47 17.45,14.03 18,14.03H19A2,2 0 0,0 21,12.03A2,2 0 0,0 19,10.03H17V9.03C17,6.27 14.76,4.03 12,4.03C9.5,4.03 7.45,5.84 7.06,8.21C6.73,8.09 6.37,8.03 6,8.03A3,3 0 0,0 3,11.03A3,3 0 0,0 6,14.03M12,14.15C12.18,14.39 12.37,14.66 12.56,14.94C13,15.56 14,17.03 14,18C14,19.11 13.1,20 12,20A2,2 0 0,1 10,18C10,17.03 11,15.56 11.44,14.94C11.63,14.66 11.82,14.4 12,14.15M12,11.03L11.5,11.59C11.5,11.59 10.65,12.55 9.79,13.81C8.93,15.06 8,16.56 8,18A4,4 0 0,0 12,22A4,4 0 0,0 16,18C16,16.56 15.07,15.06 14.21,13.81C13.35,12.55 12.5,11.59 12.5,11.59"/>`,
                    "shower rain":                      `<path d="M6,14.03A1,1 0 0,1 7,15.03C7,15.58 6.55,16.03 6,16.03C3.24,16.03 1,13.79 1,11.03C1,8.27 3.24,6.03 6,6.03C7,3.68 9.3,2.03 12,2.03C15.43,2.03 18.24,4.69 18.5,8.06L19,8.03A4,4 0 0,1 23,12.03C23,14.23 21.21,16.03 19,16.03H18C17.45,16.03 17,15.58 17,15.03C17,14.47 17.45,14.03 18,14.03H19A2,2 0 0,0 21,12.03A2,2 0 0,0 19,10.03H17V9.03C17,6.27 14.76,4.03 12,4.03C9.5,4.03 7.45,5.84 7.06,8.21C6.73,8.09 6.37,8.03 6,8.03A3,3 0 0,0 3,11.03A3,3 0 0,0 6,14.03M12,14.15C12.18,14.39 12.37,14.66 12.56,14.94C13,15.56 14,17.03 14,18C14,19.11 13.1,20 12,20A2,2 0 0,1 10,18C10,17.03 11,15.56 11.44,14.94C11.63,14.66 11.82,14.4 12,14.15M12,11.03L11.5,11.59C11.5,11.59 10.65,12.55 9.79,13.81C8.93,15.06 8,16.56 8,18A4,4 0 0,0 12,22A4,4 0 0,0 16,18C16,16.56 15.07,15.06 14.21,13.81C13.35,12.55 12.5,11.59 12.5,11.59"/>`,
                    "heavy intensity shower rain":      `<path d="M6,14.03A1,1 0 0,1 7,15.03C7,15.58 6.55,16.03 6,16.03C3.24,16.03 1,13.79 1,11.03C1,8.27 3.24,6.03 6,6.03C7,3.68 9.3,2.03 12,2.03C15.43,2.03 18.24,4.69 18.5,8.06L19,8.03A4,4 0 0,1 23,12.03C23,14.23 21.21,16.03 19,16.03H18C17.45,16.03 17,15.58 17,15.03C17,14.47 17.45,14.03 18,14.03H19A2,2 0 0,0 21,12.03A2,2 0 0,0 19,10.03H17V9.03C17,6.27 14.76,4.03 12,4.03C9.5,4.03 7.45,5.84 7.06,8.21C6.73,8.09 6.37,8.03 6,8.03A3,3 0 0,0 3,11.03A3,3 0 0,0 6,14.03M12,14.15C12.18,14.39 12.37,14.66 12.56,14.94C13,15.56 14,17.03 14,18C14,19.11 13.1,20 12,20A2,2 0 0,1 10,18C10,17.03 11,15.56 11.44,14.94C11.63,14.66 11.82,14.4 12,14.15M12,11.03L11.5,11.59C11.5,11.59 10.65,12.55 9.79,13.81C8.93,15.06 8,16.56 8,18A4,4 0 0,0 12,22A4,4 0 0,0 16,18C16,16.56 15.07,15.06 14.21,13.81C13.35,12.55 12.5,11.59 12.5,11.59"/>`,
                    "ragged shower rain":               `<path d="M6,14.03A1,1 0 0,1 7,15.03C7,15.58 6.55,16.03 6,16.03C3.24,16.03 1,13.79 1,11.03C1,8.27 3.24,6.03 6,6.03C7,3.68 9.3,2.03 12,2.03C15.43,2.03 18.24,4.69 18.5,8.06L19,8.03A4,4 0 0,1 23,12.03C23,14.23 21.21,16.03 19,16.03H18C17.45,16.03 17,15.58 17,15.03C17,14.47 17.45,14.03 18,14.03H19A2,2 0 0,0 21,12.03A2,2 0 0,0 19,10.03H17V9.03C17,6.27 14.76,4.03 12,4.03C9.5,4.03 7.45,5.84 7.06,8.21C6.73,8.09 6.37,8.03 6,8.03A3,3 0 0,0 3,11.03A3,3 0 0,0 6,14.03M12,14.15C12.18,14.39 12.37,14.66 12.56,14.94C13,15.56 14,17.03 14,18C14,19.11 13.1,20 12,20A2,2 0 0,1 10,18C10,17.03 11,15.56 11.44,14.94C11.63,14.66 11.82,14.4 12,14.15M12,11.03L11.5,11.59C11.5,11.59 10.65,12.55 9.79,13.81C8.93,15.06 8,16.56 8,18A4,4 0 0,0 12,22A4,4 0 0,0 16,18C16,16.56 15.07,15.06 14.21,13.81C13.35,12.55 12.5,11.59 12.5,11.59"/>`,

                    "light rain":           `<path d="M6,14.03A1,1 0 0,1 7,15.03C7,15.58 6.55,16.03 6,16.03C3.24,16.03 1,13.79 1,11.03C1,8.27 3.24,6.03 6,6.03C7,3.68 9.3,2.03 12,2.03C15.43,2.03 18.24,4.69 18.5,8.06L19,8.03A4,4 0 0,1 23,12.03C23,14.23 21.21,16.03 19,16.03H18C17.45,16.03 17,15.58 17,15.03C17,14.47 17.45,14.03 18,14.03H19A2,2 0 0,0 21,12.03A2,2 0 0,0 19,10.03H17V9.03C17,6.27 14.76,4.03 12,4.03C9.5,4.03 7.45,5.84 7.06,8.21C6.73,8.09 6.37,8.03 6,8.03A3,3 0 0,0 3,11.03A3,3 0 0,0 6,14.03M12,14.15C12.18,14.39 12.37,14.66 12.56,14.94C13,15.56 14,17.03 14,18C14,19.11 13.1,20 12,20A2,2 0 0,1 10,18C10,17.03 11,15.56 11.44,14.94C11.63,14.66 11.82,14.4 12,14.15M12,11.03L11.5,11.59C11.5,11.59 10.65,12.55 9.79,13.81C8.93,15.06 8,16.56 8,18A4,4 0 0,0 12,22A4,4 0 0,0 16,18C16,16.56 15.07,15.06 14.21,13.81C13.35,12.55 12.5,11.59 12.5,11.59" />`,
                    "moderate rain":        `<path d="M6,14.03A1,1 0 0,1 7,15.03C7,15.58 6.55,16.03 6,16.03C3.24,16.03 1,13.79 1,11.03C1,8.27 3.24,6.03 6,6.03C7,3.68 9.3,2.03 12,2.03C15.43,2.03 18.24,4.69 18.5,8.06L19,8.03A4,4 0 0,1 23,12.03C23,14.23 21.21,16.03 19,16.03H18C17.45,16.03 17,15.58 17,15.03C17,14.47 17.45,14.03 18,14.03H19A2,2 0 0,0 21,12.03A2,2 0 0,0 19,10.03H17V9.03C17,6.27 14.76,4.03 12,4.03C9.5,4.03 7.45,5.84 7.06,8.21C6.73,8.09 6.37,8.03 6,8.03A3,3 0 0,0 3,11.03A3,3 0 0,0 6,14.03M12,14.15C12.18,14.39 12.37,14.66 12.56,14.94C13,15.56 14,17.03 14,18C14,19.11 13.1,20 12,20A2,2 0 0,1 10,18C10,17.03 11,15.56 11.44,14.94C11.63,14.66 11.82,14.4 12,14.15M12,11.03L11.5,11.59C11.5,11.59 10.65,12.55 9.79,13.81C8.93,15.06 8,16.56 8,18A4,4 0 0,0 12,22A4,4 0 0,0 16,18C16,16.56 15.07,15.06 14.21,13.81C13.35,12.55 12.5,11.59 12.5,11.59" />`,
                    "heavy intensity rain": `<path d="M6,14.03c0.552,0,1,0.447,1,1c0,0.55-0.45,1-1,1c-2.76,0-5-2.24-5-5c0-2.76,2.24-5,5-5c1-2.35,3.3-4,6-4  c3.43,0,6.24,2.66,6.5,6.03L19,8.03c2.209,0,4,1.791,4,4c0,2.2-1.79,4-4,4h-1c-0.55,0-1-0.45-1-1c0-0.561,0.45-1,1-1h1  c1.104,0,2-0.896,2-2c0-1.105-0.896-2-2-2h-2v-1c0-2.76-2.24-5-5-5c-2.5,0-4.55,1.81-4.94,4.18C6.73,8.09,6.37,8.03,6,8.03  c-1.657,0-3,1.343-3,3S4.343,14.03,6,14.03 M12,13.56c0.091,0.12,0.185,0.255,0.28,0.395C12.5,14.265,13,15,13,15.484  c0,0.555-0.451,1-1,1c-0.552,0-1-0.447-1-1c0-0.484,0.5-1.22,0.72-1.53C11.815,13.814,11.909,13.685,12,13.56 M12,12l-0.25,0.279  c0,0-0.425,0.48-0.854,1.11C10.464,14.015,10,14.765,10,15.484c0,1.104,0.896,2,2,2c1.104,0,2-0.896,2-2  c0-0.72-0.465-1.47-0.896-2.095c-0.43-0.63-0.854-1.11-0.854-1.11 M16.082,17.56c0.092,0.12,0.186,0.255,0.281,0.395  c0.219,0.311,0.72,1.046,0.72,1.53c0,0.555-0.451,1-1.001,1c-0.551,0-1-0.447-1-1c0-0.484,0.5-1.22,0.721-1.53  C15.898,17.814,15.992,17.685,16.082,17.56 M16.082,16l-0.25,0.279c0,0-0.424,0.48-0.854,1.11c-0.432,0.625-0.896,1.375-0.896,2.095  c0,1.104,0.896,2,2,2c1.104,0,2.001-0.896,2.001-2c0-0.72-0.465-1.47-0.896-2.095c-0.43-0.63-0.854-1.11-0.854-1.11 M7.999,17.56  c0.091,0.12,0.185,0.255,0.28,0.395C8.499,18.265,9,19,9,19.484c0,0.555-0.451,1-1,1c-0.552,0-1-0.447-1-1  c0-0.484,0.5-1.22,0.72-1.53C7.814,17.814,7.908,17.685,7.999,17.56 M7.999,16l-0.25,0.279c0,0-0.425,0.48-0.854,1.11  c-0.431,0.625-0.896,1.375-0.896,2.095c0,1.104,0.896,2,2,2c1.104,0,2-0.896,2-2c0-0.72-0.465-1.47-0.896-2.095  c-0.43-0.63-0.854-1.11-0.854-1.11"/>`,
                    "very heavy rain":      `<path d="M6,14.03c0.552,0,1,0.447,1,1c0,0.55-0.45,1-1,1c-2.76,0-5-2.24-5-5c0-2.76,2.24-5,5-5c1-2.35,3.3-4,6-4  c3.43,0,6.24,2.66,6.5,6.03L19,8.03c2.209,0,4,1.791,4,4c0,2.2-1.79,4-4,4h-1c-0.55,0-1-0.45-1-1c0-0.561,0.45-1,1-1h1  c1.104,0,2-0.896,2-2c0-1.105-0.896-2-2-2h-2v-1c0-2.76-2.24-5-5-5c-2.5,0-4.55,1.81-4.94,4.18C6.73,8.09,6.37,8.03,6,8.03  c-1.657,0-3,1.343-3,3S4.343,14.03,6,14.03 M12,13.56c0.091,0.12,0.185,0.255,0.28,0.395C12.5,14.265,13,15,13,15.484  c0,0.555-0.451,1-1,1c-0.552,0-1-0.447-1-1c0-0.484,0.5-1.22,0.72-1.53C11.815,13.814,11.909,13.685,12,13.56 M12,12l-0.25,0.279  c0,0-0.425,0.48-0.854,1.11C10.464,14.015,10,14.765,10,15.484c0,1.104,0.896,2,2,2c1.104,0,2-0.896,2-2  c0-0.72-0.465-1.47-0.896-2.095c-0.43-0.63-0.854-1.11-0.854-1.11 M16.082,17.56c0.092,0.12,0.186,0.255,0.281,0.395  c0.219,0.311,0.72,1.046,0.72,1.53c0,0.555-0.451,1-1.001,1c-0.551,0-1-0.447-1-1c0-0.484,0.5-1.22,0.721-1.53  C15.898,17.814,15.992,17.685,16.082,17.56 M16.082,16l-0.25,0.279c0,0-0.424,0.48-0.854,1.11c-0.432,0.625-0.896,1.375-0.896,2.095  c0,1.104,0.896,2,2,2c1.104,0,2.001-0.896,2.001-2c0-0.72-0.465-1.47-0.896-2.095c-0.43-0.63-0.854-1.11-0.854-1.11 M7.999,17.56  c0.091,0.12,0.185,0.255,0.28,0.395C8.499,18.265,9,19,9,19.484c0,0.555-0.451,1-1,1c-0.552,0-1-0.447-1-1  c0-0.484,0.5-1.22,0.72-1.53C7.814,17.814,7.908,17.685,7.999,17.56 M7.999,16l-0.25,0.279c0,0-0.425,0.48-0.854,1.11  c-0.431,0.625-0.896,1.375-0.896,2.095c0,1.104,0.896,2,2,2c1.104,0,2-0.896,2-2c0-0.72-0.465-1.47-0.896-2.095  c-0.43-0.63-0.854-1.11-0.854-1.11"/>`,
                    "extreme rain":         `<path d="M6,14.03c0.552,0,1,0.447,1,1c0,0.55-0.45,1-1,1c-2.76,0-5-2.24-5-5c0-2.76,2.24-5,5-5c1-2.35,3.3-4,6-4  c3.43,0,6.24,2.66,6.5,6.03L19,8.03c2.209,0,4,1.791,4,4c0,2.2-1.79,4-4,4h-1c-0.55,0-1-0.45-1-1c0-0.561,0.45-1,1-1h1  c1.104,0,2-0.896,2-2c0-1.105-0.896-2-2-2h-2v-1c0-2.76-2.24-5-5-5c-2.5,0-4.55,1.81-4.94,4.18C6.73,8.09,6.37,8.03,6,8.03  c-1.657,0-3,1.343-3,3S4.343,14.03,6,14.03 M12,13.56c0.091,0.12,0.185,0.255,0.28,0.395C12.5,14.265,13,15,13,15.484  c0,0.555-0.451,1-1,1c-0.552,0-1-0.447-1-1c0-0.484,0.5-1.22,0.72-1.53C11.815,13.814,11.909,13.685,12,13.56 M12,12l-0.25,0.279  c0,0-0.425,0.48-0.854,1.11C10.464,14.015,10,14.765,10,15.484c0,1.104,0.896,2,2,2c1.104,0,2-0.896,2-2  c0-0.72-0.465-1.47-0.896-2.095c-0.43-0.63-0.854-1.11-0.854-1.11 M16.082,17.56c0.092,0.12,0.186,0.255,0.281,0.395  c0.219,0.311,0.72,1.046,0.72,1.53c0,0.555-0.451,1-1.001,1c-0.551,0-1-0.447-1-1c0-0.484,0.5-1.22,0.721-1.53  C15.898,17.814,15.992,17.685,16.082,17.56 M16.082,16l-0.25,0.279c0,0-0.424,0.48-0.854,1.11c-0.432,0.625-0.896,1.375-0.896,2.095  c0,1.104,0.896,2,2,2c1.104,0,2.001-0.896,2.001-2c0-0.72-0.465-1.47-0.896-2.095c-0.43-0.63-0.854-1.11-0.854-1.11 M7.999,17.56  c0.091,0.12,0.185,0.255,0.28,0.395C8.499,18.265,9,19,9,19.484c0,0.555-0.451,1-1,1c-0.552,0-1-0.447-1-1  c0-0.484,0.5-1.22,0.72-1.53C7.814,17.814,7.908,17.685,7.999,17.56 M7.999,16l-0.25,0.279c0,0-0.425,0.48-0.854,1.11  c-0.431,0.625-0.896,1.375-0.896,2.095c0,1.104,0.896,2,2,2c1.104,0,2-0.896,2-2c0-0.72-0.465-1.47-0.896-2.095  c-0.43-0.63-0.854-1.11-0.854-1.11"/>`,

                    "freezing rain":    `<path fill="currentColor" d="M18.5,18.67C18.5,19.96 17.5,21 16.25,21C15,21 14,19.96 14,18.67C14,17.12 16.25,14.5 16.25,14.5C16.25,14.5 18.5,17.12 18.5,18.67M4,17.36C3.86,16.82 4.18,16.25 4.73,16.11L7,15.5L5.33,13.86C4.93,13.46 4.93,12.81 5.33,12.4C5.73,12 6.4,12 6.79,12.4L8.45,14.05L9.04,11.8C9.18,11.24 9.75,10.92 10.29,11.07C10.85,11.21 11.17,11.78 11,12.33L10.42,14.58L12.67,14C13.22,13.83 13.79,14.15 13.93,14.71C14.08,15.25 13.76,15.82 13.2,15.96L10.95,16.55L12.6,18.21C13,18.6 13,19.27 12.6,19.67C12.2,20.07 11.54,20.07 11.15,19.67L9.5,18L8.89,20.27C8.75,20.83 8.18,21.14 7.64,21C7.08,20.86 6.77,20.29 6.91,19.74L7.5,17.5L5.26,18.09C4.71,18.23 4.14,17.92 4,17.36M1,11A5,5 0 0,1 6,6C7,3.65 9.3,2 12,2C15.43,2 18.24,4.66 18.5,8.03L19,8A4,4 0 0,1 23,12A4,4 0 0,1 19,16A1,1 0 0,1 18,15A1,1 0 0,1 19,14A2,2 0 0,0 21,12A2,2 0 0,0 19,10H17V9A5,5 0 0,0 12,4C9.5,4 7.45,5.82 7.06,8.19C6.73,8.07 6.37,8 6,8A3,3 0 0,0 3,11C3,11.85 3.35,12.61 3.91,13.16C4.27,13.55 4.26,14.16 3.88,14.54C3.5,14.93 2.85,14.93 2.47,14.54C1.56,13.63 1,12.38 1,11Z" />`,

                    "thunderstorm":     `<path d="M6,16A5,5 0 0,1 1,11A5,5 0 0,1 6,6C7,3.65 9.3,2 12,2C15.43,2 18.24,4.66 18.5,8.03L19,8A4,4 0 0,1 23,12A4,4 0 0,1 19,16H18A1,1 0 0,1 17,15A1,1 0 0,1 18,14H19A2,2 0 0,0 21,12A2,2 0 0,0 19,10H17V9A5,5 0 0,0 12,4C9.5,4 7.45,5.82 7.06,8.19C6.73,8.07 6.37,8 6,8A3,3 0 0,0 3,11A3,3 0 0,0 6,14H7A1,1 0 0,1 8,15A1,1 0 0,1 7,16H6M12,11H15L13,15H15L11.25,22L12,17H9.5L12,11Z"/>`,
                    "snow":             `<path d="M6,14A1,1 0 0,1 7,15A1,1 0 0,1 6,16A5,5 0 0,1 1,11A5,5 0 0,1 6,6C7,3.65 9.3,2 12,2C15.43,2 18.24,4.66 18.5,8.03L19,8A4,4 0 0,1 23,12A4,4 0 0,1 19,16H18A1,1 0 0,1 17,15A1,1 0 0,1 18,14H19A2,2 0 0,0 21,12A2,2 0 0,0 19,10H17V9A5,5 0 0,0 12,4C9.5,4 7.45,5.82 7.06,8.19C6.73,8.07 6.37,8 6,8A3,3 0 0,0 3,11A3,3 0 0,0 6,14M7.88,18.07L10.07,17.5L8.46,15.88C8.07,15.5 8.07,14.86 8.46,14.46C8.85,14.07 9.5,14.07 9.88,14.46L11.5,16.07L12.07,13.88C12.21,13.34 12.76,13.03 13.29,13.17C13.83,13.31 14.14,13.86 14,14.4L13.41,16.59L15.6,16C16.14,15.86 16.69,16.17 16.83,16.71C16.97,17.24 16.66,17.79 16.12,17.93L13.93,18.5L15.54,20.12C15.93,20.5 15.93,21.15 15.54,21.54C15.15,21.93 14.5,21.93 14.12,21.54L12.5,19.93L11.93,22.12C11.79,22.66 11.24,22.97 10.71,22.83C10.17,22.69 9.86,22.14 10,21.6L10.59,19.41L8.4,20C7.86,20.14 7.31,19.83 7.17,19.29C7.03,18.76 7.34,18.21 7.88,18.07Z"/>`,
                    "mist":             `<path d="M3,15H13A1,1 0 0,1 14,16A1,1 0 0,1 13,17H3A1,1 0 0,1 2,16A1,1 0 0,1 3,15M16,15H21A1,1 0 0,1 22,16A1,1 0 0,1 21,17H16A1,1 0 0,1 15,16A1,1 0 0,1 16,15M1,12A5,5 0 0,1 6,7C7,4.65 9.3,3 12,3C15.43,3 18.24,5.66 18.5,9.03L19,9C21.19,9 22.97,10.76 23,13H21A2,2 0 0,0 19,11H17V10A5,5 0 0,0 12,5C9.5,5 7.45,6.82 7.06,9.19C6.73,9.07 6.37,9 6,9A3,3 0 0,0 3,12C3,12.35 3.06,12.69 3.17,13H1.1L1,12M3,19H5A1,1 0 0,1 6,20A1,1 0 0,1 5,21H3A1,1 0 0,1 2,20A1,1 0 0,1 3,19M8,19H21A1,1 0 0,1 22,20A1,1 0 0,1 21,21H8A1,1 0 0,1 7,20A1,1 0 0,1 8,19Z"/>`
                }

                $.ajax({
                    url: OPEN_WEATHER_MAP_ONECALL_URL,
                    type: 'GET',
                    data: {
                        lat:    latitude,
                        lon:    longitude,
                        appid:  OPEN_WEATHER_API_KEY,
                        units: 'imperial'
                    }
                }).done(data => {
                    const DEGREE = '\u00B0';
                    const getDateTime = (dt, timezone) => new Date(dt*1000+(timezone*1000));
                    const formatDay = date => date.toLocaleString('en-us', { weekday: 'long'});
                    const formatDate = date => date.toLocaleString('en-us', { month: 'short', day: 'numeric'});
                    const formatTime = time => time.toLocaleString('en-us', { timeStyle: 'short', timeZone: 'US/Central'});
                    const buildSVG = (color, width, height, option) => {
                        return `
                        <svg fill="${color}" width="${width}" height="${height}" viewBox="0 0 24 24">
                            ${option}
                        </svg>`;
                    }

                    let currentWeather = $('#current-weather');
                    let date = formatDate(getDateTime(data.current.dt, data.timezone_offset));
                    let time = formatTime(getDateTime(data.current.dt, data.timezone_offset));
                    let sunrise = formatTime(getDateTime(data.current.sunrise, data.timezone_offset));
                    let sunset = formatTime(getDateTime(data.current.sunset, data.timezone_offset));

                    currentWeather.find('.date-time').text(`${date}, ${time}`);
                    fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${STARTING_MAPBOX_COORD[0]},${STARTING_MAPBOX_COORD[1]}.json?access_token=${MAPBOX_API_KEY}`)
                        .then(res => res.json())
                        .then(data => {
                            let address = data.features[0].place_name.split(',');
                            currentWeather.find('.city-country').text(`${address[1]}, ${address[3]}`);
                        });
                    currentWeather.find('.weather-icon').html(buildSVG("rgb(252, 154, 145)", 75, 75, svgList[`${data.current.weather[0].description}`]));
                    currentWeather.find('.current-temp').text(`${data.current.temp.toPrecision(2)}${DEGREE}F`);
                    currentWeather.find('.feels-like').text(`${data.current.feels_like.toPrecision(2)}${DEGREE}F`);
                    currentWeather.find('.clouds-description').text(`${data.current.weather[0].description}`);
                    currentWeather.find('.wind-speed').text(`Wind: ${data.current.wind_speed} mph`);
                    currentWeather.find('.humidity').text(`Humidity: ${data.current.humidity} %`);
                    currentWeather.find('.visibility').text(`Visibility: ${(data.current.visibility/1000).toFixed(1)} km`);
                    currentWeather.find('.pressure').text(`Pressure: ${data.current.pressure} hPa`);
                    currentWeather.find('.sunrise').text(`Sunrise: ${sunrise}`);
                    currentWeather.find('.sunset').text(`Sunset: ${sunset}`);

                    let weeklyWeather = $('#weekly-forecast');

                    data.daily.forEach((weekday, index) => {
                        if (index !== 0) {
                            let day = formatDay(getDateTime(weekday.dt, data.timezone_offset));
                            let t = formatTime(getDateTime(weekday.dt, data.timezone_offset));
                            weeklyWeather.find('.card-container').append(`
                            <div class="card">
                                <div class="card-body">
                                    <div class="day-time">
                                        <div class="day">${day}</div>
                                        <div class="time">${t}</div>
                                    </div>
                                    <div class="weather-icon">${buildSVG("white", 200, 200, svgList[`${weekday.weather[0].description}`])}</div>
                                    <div class="high-low">
                                        <div class="high">${weekday.temp.max.toPrecision(2)}${DEGREE}</div>
                                        <div class="low">/ ${weekday.temp.min.toPrecision(2)}${DEGREE}</div>
                                    </div>
                                    <div class="clouds-description">${weekday.weather[0].description}</div>
                                    <div class="readings">
                                        <svg style="width:24px;height:24px" viewBox="0 0 24 24"><path fill="currentColor" d="M12,3.25C12,3.25 6,10 6,14C6,17.32 8.69,20 12,20A6,6 0 0,0 18,14C18,10 12,3.25 12,3.25M14.47,9.97L15.53,11.03L9.53,17.03L8.47,15.97M9.75,10A1.25,1.25 0 0,1 11,11.25A1.25,1.25 0 0,1 9.75,12.5A1.25,1.25 0 0,1 8.5,11.25A1.25,1.25 0 0,1 9.75,10M14.25,14.5A1.25,1.25 0 0,1 15.5,15.75A1.25,1.25 0 0,1 14.25,17A1.25,1.25 0 0,1 13,15.75A1.25,1.25 0 0,1 14.25,14.5Z" /></svg>
                                        <svg style="width:24px;height:24px" viewBox="0 0 24 24"><path fill="currentColor" d="M12,2A9,9 0 0,1 21,11H13V19A3,3 0 0,1 10,22A3,3 0 0,1 7,19V18H9V19A1,1 0 0,0 10,20A1,1 0 0,0 11,19V11H3A9,9 0 0,1 12,2Z" /></svg>
                                        <svg style="width:24px;height:24px" viewBox="0 0 24 24"><path fill="currentColor" d="M4,10A1,1 0 0,1 3,9A1,1 0 0,1 4,8H12A2,2 0 0,0 14,6A2,2 0 0,0 12,4C11.45,4 10.95,4.22 10.59,4.59C10.2,5 9.56,5 9.17,4.59C8.78,4.2 8.78,3.56 9.17,3.17C9.9,2.45 10.9,2 12,2A4,4 0 0,1 16,6A4,4 0 0,1 12,10H4M19,12A1,1 0 0,0 20,11A1,1 0 0,0 19,10C18.72,10 18.47,10.11 18.29,10.29C17.9,10.68 17.27,10.68 16.88,10.29C16.5,9.9 16.5,9.27 16.88,8.88C17.42,8.34 18.17,8 19,8A3,3 0 0,1 22,11A3,3 0 0,1 19,14H5A1,1 0 0,1 4,13A1,1 0 0,1 5,12H19M18,18H4A1,1 0 0,1 3,17A1,1 0 0,1 4,16H18A3,3 0 0,1 21,19A3,3 0 0,1 18,22C17.17,22 16.42,21.66 15.88,21.12C15.5,20.73 15.5,20.1 15.88,19.71C16.27,19.32 16.9,19.32 17.29,19.71C17.47,19.89 17.72,20 18,20A1,1 0 0,0 19,19A1,1 0 0,0 18,18Z" /></svg>
                                        <div class="precipitation">${weekday.pop}%</div>
                                        <div class="humidity">${weekday.humidity}%</div>
                                        <div class="wind-speed">${weekday.wind_speed}</div>
                                    </div>
                                </div>
                            </div>
                        `);
                        }
                    });
                });
            }

            /*----------------------------------
            NEWS API LOGIC
            ----------------------------------*/
            //--| Purpose: Fills the 5 news cards with current weather related news stories. |--//
            function getNews() {
                let createUrl = (search, date, sortBy, key) => { return `https://newsapi.org/v2/everything?q=${search}&from=${date}&sortBy=${sortBy}&apiKey=${key}`; }
                let url = createUrl('Weather', '2022-02-02', 'relevancy', NEWS_API_KEY);
                fetch(new Request(url))
                    .then(res => res.json())
                    .then(data => {
                        let articles = data.articles;
                        $('.news-card').each(function(index){
                            $(this).find('img').attr('src', `${articles[index].urlToImage}`);
                            $(this).find('h5').html(`${articles[index].source.name}`);
                            $(this).find('p').html(`${articles[index].title}`);
                            $(this).find('small').html(`${formatDate(new Date(articles[index].publishedAt.slice(0, -1)))}`);
                            $(this).find('a').attr('href', `${articles[index].url}`);
                        });
                    });
            }

            /*----------------------------------
            GLOBAL FUNCTION CALLS
            ----------------------------------*/

            getOpenWeatherData(STARTING_MAPBOX_COORD[0], STARTING_MAPBOX_COORD[1]);
            getNews();

        </script>
    </body>
</html>